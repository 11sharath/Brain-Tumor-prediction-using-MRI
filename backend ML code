import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn as sk
import xgboost as xgb
import pickle
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
from sklearn.preprocessing import LabelEncoder
df = pd.read_csv("/content/brain_mri_radiomics_100k.csv")
df['sex'] = df['sex'].fillna('Unknown')
le = LabelEncoder()
df['tumor_present'] = le.fit_transform(df['tumor_present'])
df['sex'] = le.fit_transform(df['sex'])
x = df[["age", "sex", "mean_intensity", "std_intensity", "snr", "glcm_contrast", "entropy", "lesion_volume_cc"]]
y = df["tumor_present"]
x = x.fillna(x.mean())
y = y.fillna(y.mode()[0])
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=42)
from sklearn.linear_model import LinearRegression
model=LinearRegression()
model.fit(x_train,y_train)
Y_pred=model.predict(x_test)
from sklearn.metrics import r2_score
r2 = r2_score(y_test,Y_pred)
r2
